import{j as e}from"./jsx-runtime.D_zvdyIk.mjs";import{r as s}from"./index.Da02gyCa.mjs";function f(){const[r,m]=s.useState(""),[i,c]=s.useState([]),[u,l]=s.useState(!1),[p,n]=s.useState(!1),o=s.useRef(null);return s.useEffect(()=>{if(o.current&&clearTimeout(o.current),!r.trim()){c([]),n(!1);return}return l(!0),o.current=setTimeout(async()=>{try{const a=await(await fetch(`/api/search/products?q=${encodeURIComponent(r)}`)).json();c(a.results||[]),n(!0)}catch(t){console.error("Error searching:",t),c([])}finally{l(!1)}},300),()=>{o.current&&clearTimeout(o.current)}},[r]),s.useEffect(()=>{const t=a=>{a.target.closest("[data-live-search]")||n(!1)};return document.addEventListener("click",t),()=>document.removeEventListener("click",t)},[]),e.jsxs("div",{className:"relative","data-live-search":!0,children:[e.jsxs("div",{className:"relative",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-primary-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",placeholder:"Buscar productos...",value:r,onChange:t=>m(t.target.value),onFocus:()=>r.trim()&&n(!0),className:"w-full pl-10 pr-4 py-2 border border-primary-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-600 text-sm"}),u&&e.jsxs("svg",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-primary-600 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})]}),p&&r.trim()&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-primary-200 rounded-lg shadow-lg z-50 max-h-96 overflow-y-auto",children:i.length>0?e.jsx("div",{className:"divide-y divide-primary-100",children:i.map(t=>{const a=t.price/100,d=a*(1-t.discount_percentage/100);return e.jsxs("a",{href:`/productos/${t.slug}`,className:"flex items-center gap-3 p-3 hover:bg-primary-50 transition-colors",children:[t.image_url&&e.jsx("img",{src:t.image_url,alt:t.name,className:"w-12 h-12 object-cover rounded"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-primary-900 truncate",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-primary-600",children:["€",d.toFixed(2)]}),t.discount_percentage>0&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xs text-primary-400 line-through",children:["€",a.toFixed(2)]}),e.jsxs("span",{className:"text-xs bg-red-100 text-red-600 px-1.5 py-0.5 rounded",children:["-",t.discount_percentage,"%"]})]})]})]})]},t.id)})}):e.jsxs("div",{className:"p-6 text-center text-sm text-primary-500",children:[e.jsxs("p",{children:['No encontramos "',r,'"']}),e.jsx("p",{className:"text-xs text-primary-400 mt-1",children:"Prueba con otros términos"})]})})]})}export{f as default};
