import{j as r}from"./jsx-runtime.D_zvdyIk.mjs";import{r as d}from"./index.Da02gyCa.mjs";function w({orderId:i,orderNumber:l,authToken:m}){const[a,t]=d.useState(!1),[s,n]=d.useState(""),u=async()=>{t(!0),n("");try{const e=await fetch(`/api/invoices/generate?orderId=${i}`,{headers:{Authorization:`Bearer ${m||localStorage.getItem("sb-access-token")||""}`}});if(!e.ok){const f=await e.json();throw new Error(f.error||"Error descargando factura")}const p=await e.blob(),c=window.URL.createObjectURL(p),o=document.createElement("a");o.href=c,o.download=`factura-${l}.pdf`,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(c)}catch(e){console.error("Download error:",e),n(e instanceof Error?e.message:"Error descargando factura")}finally{t(!1)}};return r.jsxs("div",{children:[r.jsx("button",{onClick:u,disabled:a,className:"w-full flex items-center justify-center gap-2 px-4 py-3 text-primary-600 hover:bg-primary-50 transition-colors rounded-lg border border-primary-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed",title:"Descargar factura en PDF",children:a?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"w-4 h-4 border-2 border-primary-600 border-t-transparent rounded-full animate-spin"}),"Descargando..."]}):r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M12 8v4m0 4v.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Descargar factura"]})}),s&&r.jsxs("p",{className:"text-sm text-red-600 mt-2",children:["‚ùå ",s]})]})}export{w as default};
