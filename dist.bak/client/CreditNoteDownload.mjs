import{j as e}from"./jsx-runtime.D_zvdyIk.mjs";import{r as i}from"./index.Da02gyCa.mjs";function x({returnRequestId:c,originalOrderId:l,orderNumber:m,authToken:b}){const[t,a]=i.useState(!1),[n,s]=i.useState(""),h=async()=>{a(!0),s("");try{const o=await fetch("/api/invoices/credit-note",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b||localStorage.getItem("sb-access-token")||""}`},body:JSON.stringify({returnRequestId:c,originalOrderId:l})});if(!o.ok){const u=await o.json();throw new Error(u.error||"Error descargando abono")}const p=await o.blob(),d=window.URL.createObjectURL(p),r=document.createElement("a");r.href=d,r.download=`abono-${m}.pdf`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(d)}catch(o){console.error("Download error:",o),s(o instanceof Error?o.message:"Error descargando abono")}finally{a(!1)}};return e.jsxs("div",{children:[e.jsx("button",{onClick:h,disabled:t,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 disabled:bg-red-300 disabled:cursor-not-allowed transition-colors",title:"Descargar nota de crédito",children:t?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Descargando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Descargar abono"]})}),n&&e.jsxs("p",{className:"text-sm text-red-600 mt-2",children:["❌ ",n]})]})}export{x as default};
