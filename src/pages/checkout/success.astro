---
/**
 * Checkout Success Page - SSR
 */
import PublicLayout from '@layouts/PublicLayout.astro';

export const prerender = false;

// Get session_id from URL
const sessionId = Astro.url.searchParams.get('session_id');
---

<PublicLayout title="Pedido confirmado" showPromoBar={false}>
  <div class="max-w-2xl mx-auto px-4 py-20 text-center">
    <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-8">
      <svg class="w-10 h-10 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
      </svg>
    </div>
    
    <h1 class="font-display text-4xl mb-4">¡Gracias por tu pedido!</h1>
    <p class="text-primary-600 text-lg mb-8">
      Tu pedido ha sido confirmado y está siendo procesado.
      Recibirás un email de confirmación en breve.
    </p>
    
    {sessionId && (
      <p class="text-sm text-primary-500 mb-8">
        ID de transacción: <span class="font-mono">{sessionId}</span>
      </p>
    )}
    
    <div class="bg-primary-50 p-6 text-left mb-8">
      <h2 class="font-medium mb-4">¿Qué pasa ahora?</h2>
      <ul class="space-y-3 text-sm text-primary-600">
        <li class="flex items-start gap-3">
          <span class="w-6 h-6 bg-primary-900 text-white rounded-full flex items-center justify-center flex-shrink-0 text-xs">1</span>
          <span>Recibirás un email de confirmación con los detalles de tu pedido.</span>
        </li>
        <li class="flex items-start gap-3">
          <span class="w-6 h-6 bg-primary-900 text-white rounded-full flex items-center justify-center flex-shrink-0 text-xs">2</span>
          <span>Prepararemos tu pedido con el máximo cuidado.</span>
        </li>
        <li class="flex items-start gap-3">
          <span class="w-6 h-6 bg-primary-900 text-white rounded-full flex items-center justify-center flex-shrink-0 text-xs">3</span>
          <span>Te enviaremos un email con el número de seguimiento cuando tu pedido sea enviado.</span>
        </li>
      </ul>
    </div>
    
    <div class="flex flex-col sm:flex-row gap-4 justify-center">
      <a 
        href="/productos" 
        class="bg-primary-900 text-white px-8 py-3 text-sm tracking-widest uppercase hover:bg-primary-800 transition-colors"
      >
        Seguir comprando
      </a>
      <a 
        href="/" 
        class="border border-primary-300 px-8 py-3 text-sm tracking-widest uppercase hover:bg-primary-50 transition-colors"
      >
        Volver al inicio
      </a>
    </div>
  </div>
  
  <script>
    // Clear cart after successful checkout
    localStorage.removeItem('fashionstore-cart');
    
    // Dispatch event to update cart UI
    window.dispatchEvent(new CustomEvent('cart:clear'));
  </script>
</PublicLayout>
